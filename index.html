<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tax Refund Estimator 2024</title>
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">
  <div class="max-w-4xl mx-auto p-4">
    <h1 class="text-3xl font-bold text-center mb-6">Tax Refund Estimator 2024</h1>
    <div id="estimator" class="bg-white shadow rounded p-6">
      
      <!-- Step 1: Filing Status & Personal Information -->
      <div class="mb-4">
        <h2 class="text-xl font-semibold mb-2">Step 1: Filing Status & Personal Information</h2>
        <div class="mb-2">
          <label for="filingStatus" class="block text-sm font-medium text-gray-700">
            Filing Status
            <span class="text-blue-500 cursor-help" title="Select your filing status: Single, Married Filing Jointly, Married Filing Separately, Head of Household.">?</span>
          </label>
          <select id="filingStatus" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm">
            <option value="single">Single</option>
            <option value="mfj">Married Filing Jointly</option>
            <option value="mfs">Married Filing Separately</option>
            <option value="hoh">Head of Household</option>
          </select>
        </div>
        <div class="mb-2">
          <label for="stateSelect" class="block text-sm font-medium text-gray-700">
            State of Residence
            <span class="text-blue-500 cursor-help" title="Select your state for state tax calculations.">?</span>
          </label>
          <select id="stateSelect" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm">
            <option value="">Select a state</option>
            <option value="AL">Alabama</option>
            <option value="AK">Alaska</option>
            <option value="AZ">Arizona</option>
            <option value="AR">Arkansas</option>
            <option value="CA">California</option>
            <option value="CO">Colorado</option>
            <option value="CT">Connecticut</option>
            <option value="DE">Delaware</option>
            <option value="FL">Florida</option>
            <option value="GA">Georgia</option>
            <option value="HI">Hawaii</option>
            <option value="ID">Idaho</option>
            <option value="IL">Illinois</option>
            <option value="IN">Indiana</option>
            <option value="IA">Iowa</option>
            <option value="KS">Kansas</option>
            <option value="KY">Kentucky</option>
            <option value="LA">Louisiana</option>
            <option value="ME">Maine</option>
            <option value="MD">Maryland</option>
            <option value="MA">Massachusetts</option>
            <option value="MI">Michigan</option>
            <option value="MN">Minnesota</option>
            <option value="MS">Mississippi</option>
            <option value="MO">Missouri</option>
            <option value="MT">Montana</option>
            <option value="NE">Nebraska</option>
            <option value="NV">Nevada</option>
            <option value="NH">New Hampshire</option>
            <option value="NJ">New Jersey</option>
            <option value="NM">New Mexico</option>
            <option value="NY">New York</option>
            <option value="NC">North Carolina</option>
            <option value="ND">North Dakota</option>
            <option value="OH">Ohio</option>
            <option value="OK">Oklahoma</option>
            <option value="OR">Oregon</option>
            <option value="PA">Pennsylvania</option>
            <option value="RI">Rhode Island</option>
            <option value="SC">South Carolina</option>
            <option value="SD">South Dakota</option>
            <option value="TN">Tennessee</option>
            <option value="TX">Texas</option>
            <option value="UT">Utah</option>
            <option value="VT">Vermont</option>
            <option value="VA">Virginia</option>
            <option value="WA">Washington</option>
            <option value="WV">West Virginia</option>
            <option value="WI">Wisconsin</option>
            <option value="WY">Wyoming</option>
          </select>
        </div>
      </div>

      <!-- Step 2: Income & Deductions -->
      <div class="mb-4">
        <h2 class="text-xl font-semibold mb-2">Step 2: Income & Deductions</h2>
        <div class="mb-2">
          <label for="income" class="block text-sm font-medium text-gray-700">
            Total Income ($)
            <span class="text-blue-500 cursor-help" title="Enter your total income before taxes.">?</span>
          </label>
          <input type="number" id="income" placeholder="e.g., 50000" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm" />
        </div>
        <div class="mb-2">
          <label for="deductions" class="block text-sm font-medium text-gray-700">
            Total Deductions ($)
            <span class="text-blue-500 cursor-help" title="Enter your total deductions (either standard or itemized).">?</span>
          </label>
          <input type="number" id="deductions" placeholder="e.g., 12000" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm" />
        </div>
      </div>

      <!-- Step 3: Withholdings & Additional Taxes -->
      <div class="mb-4">
        <h2 class="text-xl font-semibold mb-2">Step 3: Withholdings & Additional Taxes</h2>
        <div class="mb-2">
          <label for="withholdings" class="block text-sm font-medium text-gray-700">
            Tax Withholdings ($)
            <span class="text-blue-500 cursor-help" title="Enter the total federal tax withheld.">?</span>
          </label>
          <input type="number" id="withholdings" placeholder="e.g., 6000" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm" />
        </div>
        <div class="mb-2">
          <label for="socialTax" class="block text-sm font-medium text-gray-700">
            Social Security & Medicare Taxes ($)
            <span class="text-blue-500 cursor-help" title="Enter your Social Security & Medicare taxes if applicable.">?</span>
          </label>
          <input type="number" id="socialTax" placeholder="e.g., 4000" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm" />
        </div>
      </div>

      <!-- Step 4: Alternative Minimum Tax (AMT) -->
      <div class="mb-4">
        <h2 class="text-xl font-semibold mb-2">Step 4: Alternative Minimum Tax (AMT)</h2>
        <div class="mb-2">
          <label for="amtIncome" class="block text-sm font-medium text-gray-700">
            AMT Adjusted Income ($)
            <span class="text-blue-500 cursor-help" title="Enter your AMT adjusted income if applicable.">?</span>
          </label>
          <input type="number" id="amtIncome" placeholder="e.g., 50000" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm" />
        </div>
      </div>

      <!-- Tax Summary & Actions -->
      <div class="mt-6 p-4 bg-gray-50 rounded">
        <h2 class="text-xl font-semibold mb-2">Tax Summary</h2>
        <div id="taxSummary" class="text-lg font-medium">
          Please fill in the details above.
        </div>
        <div class="mt-4">
          <button id="printBtn" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
            Print Summary
          </button>
          <button id="exportBtn" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 ml-2">
            Export Data
          </button>
        </div>
      </div>
    </div>
    <div class="mt-6 text-sm text-gray-600">
      <p>Disclaimer: This estimator is for informational purposes only. Always consult a tax professional for official advice.</p>
      <p class="mt-2 text-red-600 font-bold">Warning: Ensure accuracy to avoid common IRS audit risks.</p>
    </div>
  </div>

  <script>
    // --- Federal Tax Brackets for 2024 (Simplified Example) ---
    const federalTaxBrackets = {
      single: [
        { rate: 0.10, cap: 11000 },
        { rate: 0.12, cap: 44725 },
        { rate: 0.22, cap: 95375 },
        { rate: 0.24, cap: 182100 },
        { rate: 0.32, cap: 231250 },
        { rate: 0.35, cap: 578125 },
        { rate: 0.37, cap: Infinity }
      ],
      mfj: [
        { rate: 0.10, cap: 22000 },
        { rate: 0.12, cap: 89450 },
        { rate: 0.22, cap: 190750 },
        { rate: 0.24, cap: 364200 },
        { rate: 0.32, cap: 462500 },
        { rate: 0.35, cap: 693750 },
        { rate: 0.37, cap: Infinity }
      ],
      mfs: [
        { rate: 0.10, cap: 11000 },
        { rate: 0.12, cap: 44725 },
        { rate: 0.22, cap: 95375 },
        { rate: 0.24, cap: 182100 },
        { rate: 0.32, cap: 231250 },
        { rate: 0.35, cap: 346875 },
        { rate: 0.37, cap: Infinity }
      ],
      hoh: [
        { rate: 0.10, cap: 15700 },
        { rate: 0.12, cap: 59850 },
        { rate: 0.22, cap: 95350 },
        { rate: 0.24, cap: 176250 },
        { rate: 0.32, cap: 231250 },
        { rate: 0.35, cap: 578100 },
        { rate: 0.37, cap: Infinity }
      ]
    };

    // --- Simplified State Tax Rates (Example Data) ---
    // Note: Real state taxes are often progressive. Here we use flat rates for demonstration.
    const stateTaxRates = {
      AL: 0.05,
      AK: 0.00,
      AZ: 0.045,
      AR: 0.065,
      CA: 0.09,
      CO: 0.0463,
      CT: 0.0699,
      DE: 0.066,
      FL: 0.00,
      GA: 0.0575,
      HI: 0.08,
      ID: 0.069,
      IL: 0.05,
      IN: 0.0323,
      IA: 0.085,
      KS: 0.057,
      KY: 0.05,
      LA: 0.06,
      ME: 0.0715,
      MD: 0.0575,
      MA: 0.05,
      MI: 0.0425,
      MN: 0.0785,
      MS: 0.05,
      MO: 0.054,
      MT: 0.06,
      NE: 0.0684,
      NV: 0.00,
      NH: 0.05, // Only on interest & dividends
      NJ: 0.0637,
      NM: 0.049,
      NY: 0.0685,
      NC: 0.0525,
      ND: 0.022,
      OH: 0.04997,
      OK: 0.05,
      OR: 0.09,
      PA: 0.0307,
      RI: 0.0599,
      SC: 0.07,
      SD: 0.00,
      TN: 0.00,
      TX: 0.00,
      UT: 0.0495,
      VT: 0.08,
      VA: 0.0575,
      WA: 0.00,
      WV: 0.065,
      WI: 0.0765,
      WY: 0.00
    };

    // --- Function: Calculate Federal Tax ---
    function calculateFederalTax(taxableIncome, status) {
      const brackets = federalTaxBrackets[status];
      let tax = 0;
      let previousCap = 0;
      for (const bracket of brackets) {
        if (taxableIncome > bracket.cap) {
          tax += (bracket.cap - previousCap) * bracket.rate;
          previousCap = bracket.cap;
        } else {
          tax += (taxableIncome - previousCap) * bracket.rate;
          break;
        }
      }
      return tax;
    }

    // --- Function: Calculate AMT (Simplified) ---
    function calculateAMT(amtIncome) {
      // For demonstration: 26% on the first $220,700, then 28% on the remainder.
      if (amtIncome <= 220700) {
        return amtIncome * 0.26;
      } else {
        return 220700 * 0.26 + (amtIncome - 220700) * 0.28;
      }
    }

    // --- Function: Calculate Social Security & Medicare Taxes ---
    function calculateFICA(income) {
      // Simplified: 6.2% Social Security (up to wage base) and 1.45% Medicare (no cap)
      const socialSecurityWageBase = 160200; // 2024 wage base
      const socialSecurityTax = Math.min(income, socialSecurityWageBase) * 0.062;
      const medicareTax = income * 0.0145;
      return socialSecurityTax + medicareTax;
    }

    // --- Main Calculation Function ---
    function updateCalculations() {
      const filingStatus = document.getElementById('filingStatus').value;
      const income = parseFloat(document.getElementById('income').value) || 0;
      const deductions = parseFloat(document.getElementById('deductions').value) || 0;
      const withholdings = parseFloat(document.getElementById('withholdings').value) || 0;
      const socialTaxInput = parseFloat(document.getElementById('socialTax').value) || 0;
      const amtIncome = parseFloat(document.getElementById('amtIncome').value) || 0;
      const state = document.getElementById('stateSelect').value;

      // Compute taxable income (simplified)
      const taxableIncome = Math.max(income - deductions, 0);

      // Federal tax using standard brackets
      const federalTax = calculateFederalTax(taxableIncome, filingStatus);

      // AMT: if provided, calculate and use the higher of regular tax and AMT.
      const amtTax = amtIncome > 0 ? calculateAMT(amtIncome) : 0;
      const totalFederalTax = Math.max(federalTax, amtTax);

      // FICA: use user input if provided; otherwise, calculate.
      const ficaTax = socialTaxInput || calculateFICA(income);

      // State tax: based on a flat rate multiplied by taxable income.
      let stateTax = 0;
      if (state && stateTaxRates.hasOwnProperty(state)) {
        stateTax = taxableIncome * stateTaxRates[state];
      }

      // Total Tax Liability
      const totalTaxLiability = totalFederalTax + stateTax + ficaTax;

      // Determine refund (or amount owed)
      const refundOrOwed = withholdings - totalTaxLiability;

      // Update display with visual indicators
      const taxSummaryDiv = document.getElementById('taxSummary');
      let resultHTML = `<p>Taxable Income: $${taxableIncome.toFixed(2)}</p>`;
      resultHTML += `<p>Federal Tax: $${federalTax.toFixed(2)}</p>`;
      if (amtTax > federalTax) {
        resultHTML += `<p class="text-orange-600">AMT Applied: $${amtTax.toFixed(2)}</p>`;
      }
      resultHTML += `<p>State Tax: $${stateTax.toFixed(2)}</p>`;
      resultHTML += `<p>Social Security & Medicare Taxes: $${ficaTax.toFixed(2)}</p>`;
      resultHTML += `<p><strong>Total Tax Liability: $${totalTaxLiability.toFixed(2)}</strong></p>`;
      if (refundOrOwed >= 0) {
        resultHTML += `<p class="text-green-600 font-bold">Expected Refund: $${refundOrOwed.toFixed(2)}</p>`;
      } else {
        resultHTML += `<p class="text-red-600 font-bold">Tax Owed: $${Math.abs(refundOrOwed).toFixed(2)}</p>`;
      }
      taxSummaryDiv.innerHTML = resultHTML;
    }

    // --- Event Listeners for Real-Time Updates ---
    document.querySelectorAll('#estimator input, #estimator select').forEach(el => {
      el.addEventListener('input', updateCalculations);
      el.addEventListener('change', updateCalculations);
    });

    // --- Print Summary Functionality ---
    document.getElementById('printBtn').addEventListener('click', () => {
      window.print();
    });

    // --- Export Data Functionality ---
    document.getElementById('exportBtn').addEventListener('click', () => {
      const data = {
        filingStatus: document.getElementById('filingStatus').value,
        state: document.getElementById('stateSelect').value,
        income: document.getElementById('income').value,
        deductions: document.getElementById('deductions').value,
        withholdings: document.getElementById('withholdings').value,
        socialTax: document.getElementById('socialTax').value,
        amtIncome: document.getElementById('amtIncome').value
      };
      const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(data, null, 2));
      const dlAnchorElem = document.createElement('a');
      dlAnchorElem.setAttribute("href", dataStr);
      dlAnchorElem.setAttribute("download", "tax_data.json");
      dlAnchorElem.click();
    });

    // Initial calculation to populate summary on load.
    updateCalculations();
  </script>
</body>
</html>
